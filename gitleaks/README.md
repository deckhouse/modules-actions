# üïµÔ∏è Gitleaks GitHub Action

## üìå –ß—Ç–æ —ç—Ç–æ —Ç–∞–∫–æ–µ

–≠—Ç–æ—Ç GitHub Actions workflow –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–ø—É—Å–∫–∞–µ—Ç [Gitleaks](https://github.com/gitleaks/gitleaks) ‚Äî –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –ø–æ–∏—Å–∫–∞ —Å–µ–∫—Ä–µ—Ç–æ–≤ –≤ –∫–æ–¥–µ (—Ç–æ–∫–µ–Ω—ã, –∫–ª—é—á–∏, –ø–∞—Ä–æ–ª–∏ –∏ —Ç.–ø.). –û–Ω —Å–∫–∞–Ω–∏—Ä—É–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è –ª–∏–±–æ –ø–æ–ª–Ω–æ—Å—Ç—å—é, –ª–∏–±–æ –≤ –≤–∏–¥–µ diff-–∞ –¥–ª—è Pull Request'–æ–≤.

–¶–µ–ª—å ‚Äî –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—Ç–∏—Ç—å —É—Ç–µ—á–∫—É —Å–µ–∫—Ä–µ—Ç–æ–≤ –≤ –ø—É–±–ª–∏—á–Ω—ã–µ –∏–ª–∏ –ø—Ä–∏–≤–∞—Ç–Ω—ã–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ –¥–æ –ø–æ–ø–∞–¥–∞–Ω–∏—è –∫–æ–¥–∞ –≤ –æ—Å–Ω–æ–≤–Ω—É—é –≤–µ—Ç–∫—É.

---

## ‚öôÔ∏è –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç

Workflow —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ –¥–≤—É—Ö —Ä–µ–∂–∏–º–æ–≤:

- **Diff scan** (—Ä–µ–∂–∏–º –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –¥–ª—è PR):
  - –ó–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∏–ª–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ Pull Request.
  - –°–∫–∞–Ω–∏—Ä—É–µ—Ç —Ç–æ–ª—å–∫–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è –º–µ–∂–¥—É —Ç–µ–∫—É—â–µ–π –≤–µ—Ç–∫–æ–π –∏ —Ü–µ–ª–µ–≤–æ–π (base) –≤–µ—Ç–∫–æ–π.

- **Full scan**:
  - –ó–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é –∏–ª–∏ –≤—Ä—É—á–Ω—É—é.
  - –°–∫–∞–Ω–∏—Ä—É–µ—Ç –≤–µ—Å—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π.

–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:

- üìÑ `gitleaks.yml`: –æ—Å–Ω–æ–≤–Ω–æ–π workflow —Å —Ç—Ä–µ–º—è —Ç—Ä–∏–≥–≥–µ—Ä–∞–º–∏ ‚Äî `pull_request`, `schedule`, `workflow_dispatch`.
- ‚öôÔ∏è `deckhouse/modules-actions/gitleaks@feature/gitleaks`: composite action, —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—â–∞—è –∏ –∑–∞–ø—É—Å–∫–∞—é—â–∞—è Gitleaks.
- üõ† `gitleaks.toml` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ): –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Ñ–∞–π–ª –ø—Ä–∞–≤–∏–ª –¥–ª—è Gitleaks –≤ –∫–æ—Ä–Ω–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è. –ï—Å–ª–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç ‚Äî –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞ Gitleaks.

---

## üöÄ –ö–∞–∫ –ø–æ–¥–∫–ª—é—á–∏—Ç—å

### 1. (–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –î–æ–±–∞–≤—å—Ç–µ –∫–æ–Ω—Ñ–∏–≥ Gitleaks

–ï—Å–ª–∏ –≤—ã —Ö–æ—Ç–∏—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è, —Å–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `gitleaks.toml` –≤ **–∫–æ—Ä–Ω–µ** –≤–∞—à–µ–≥–æ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è. –ü—Ä–∏–º–µ—Ä –º–æ–∂–Ω–æ –≤–∑—è—Ç—å –∏–∑ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–≥–æ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è Gitleaks:  
üìé <https://github.com/gitleaks/gitleaks/blob/main/config/gitleaks.toml>

**–ï—Å–ª–∏ —Ñ–∞–π–ª –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç:** Gitleaks –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –¥–µ—Ñ–æ–ª—Ç–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞.

### 2. –î–æ–±–∞–≤—å—Ç–µ workflow-—Ñ–∞–π–ª

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.github/workflows/gitleaks.yml` —Å–æ —Å–ª–µ–¥—É—é—â–∏–º —Å–æ–¥–µ—Ä–∂–∏–º—ã–º:

```yaml
name: Gitleaks

on:
  pull_request:
    types: [opened, synchronize, reopened, ready_for_review]
  schedule:
    - cron: "0 2 * * *"  # –µ–∂–µ–¥–Ω–µ–≤–Ω–æ –≤ 02:00 UTC
  workflow_dispatch: {}  # —Ä—É—á–Ω–æ–π –∑–∞–ø—É—Å–∫

permissions:
  contents: read

concurrency:
  group: "gitleaks-${{ github.ref }}"
  cancel-in-progress: false

jobs:
  gitleaks-diff:
    if: ${{ github.event_name == 'pull_request' }}
    runs-on: ubuntu-latest
    steps:
      - uses: deckhouse/modules-actions/gitleaks@feature/gitleaks
        with:
          scan_mode: diff
          # gitleaks_version: v8.28.0  # –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é v8.28.0

  gitleaks-full:
    if: ${{ github.event_name != 'pull_request' }}
    runs-on: ubuntu-latest
    continue-on-error: true
    steps:
      - uses: deckhouse/modules-actions/gitleaks@feature/gitleaks
        with:
          scan_mode: full
          # gitleaks_version: v8.28.0  # –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é v8.28.0
```

---

## üìù –í—Ö–æ–¥–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã (Inputs)

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –û–ø–∏—Å–∞–Ω–∏–µ | –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π | –ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é |
|----------|----------|--------------|----------------------|
| `scan_mode` | –†–µ–∂–∏–º —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è: `full` –∏–ª–∏ `diff` | –ù–µ—Ç | `full` |
| `gitleaks_version` | –í–µ—Ä—Å–∏—è Gitleaks –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ | –ù–µ—Ç | `v8.28.0` |

### –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –≤–µ—Ä—Å–∏–∏ Gitleaks:**

```yaml
- uses: deckhouse/modules-actions/gitleaks@feature/gitleaks
  with:
    scan_mode: full
    gitleaks_version: v8.20.0
```

**–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (–∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–µ—Ñ–æ–ª—Ç—ã):**

```yaml
- uses: deckhouse/modules-actions/gitleaks@feature/gitleaks
